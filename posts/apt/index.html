<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  









  



  
  

<link rel="stylesheet" href="https://pipminder00.github.io/scss/main.min.css" />
  
<meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  

<title>APT1 Hitman CTFs | Macro &amp; Network</title>


<meta name="author" content="Aminah Abdulah">

<meta name="description" content="Personal blog site of Aminah Abdulah.">
<link rel="canonical" href="https://pipminder00.github.io/posts/apt/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="APT1 Hitman CTFs | Macro &amp; Network">
<meta property="og:description" content="بسم الله الرحمن الرحيم
بكتب اليوم لكم عن تحدي APT1 اللي نزله hitman بتويتر، حللت أبو التحدي الصراحه رهيب! أول مرة احلل وانا فاهمه بوريكم 3 طرق تحلونه فيه
نستخدم macro editor حق word نفسه نستخدم تولز اسمها OleVba ونحلل منها نشوف procmon نبدأ ؟
أول شيء عطانا ملف pcapng حق الشبكة سويت follow stream عشان افهم شنو اللي قاعد يصير ، فهمت ان عندي ملف يتسوى لها upload طيب نضغط عالباكيت ونشوف شنو data اللي قاعد يسوي له post ؟ حلوين نسوي export packet byte ونبدأ شغل عليها، طيب الحين لو غيرت ext لـ zip راح يحذفه لي windows defender فخلونا ننقل الملفات الى isolated machine هنا عرفت انه word بوريكم شي يوضح لكم فكرة مايكروسفت في حفظ docm">
<meta property="og:url" content="https://pipminder00.github.io/posts/apt/">
<meta property="article:published_time" content="2023-07-11T03:23:58+03:00">
  <meta property="article:modified_time" content="2023-07-11T03:23:58+03:00">
  


  <meta name="og:image" content="https://pipminder00.github.io/images/default.png"/>





  <meta name="twitter:site" content="amenaham">


  <meta name="twitter:creator" content="Amenaham">

<meta name="twitter:title" content="APT1 Hitman CTFs | Macro &amp; Network">
<meta name="twitter:description" content="بسم الله الرحمن الرحيم
بكتب اليوم لكم عن تحدي APT1 اللي نزله hitman بتويتر، حللت أبو التحدي الصراحه رهيب! أول مرة احلل وانا فاهمه بوريكم 3 طرق تحلونه فيه
نستخدم macro editor حق word نفسه نستخدم تولز اسمها OleVba ونحلل منها نشوف procmon نبدأ ؟
أول شيء عطانا ملف pcapng حق الشبكة سويت follow stream عشان افهم شنو اللي قاعد يصير ، فهمت ان عندي ملف يتسوى لها upload طيب نضغط عالباكيت ونشوف شنو data اللي قاعد يسوي له post ؟ حلوين نسوي export packet byte ونبدأ شغل عليها، طيب الحين لو غيرت ext لـ zip راح يحذفه لي windows defender فخلونا ننقل الملفات الى isolated machine هنا عرفت انه word بوريكم شي يوضح لكم فكرة مايكروسفت في حفظ docm">



  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://pipminder00.github.io/images/default.png"/>





  


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
      "@id": "https://pipminder00.github.io/#/schema/person/1",
      "name": "Aminah Abdulah",
      "url": "https://pipminder00.github.io/",
      "image": {
        "@type": "ImageObject",
        "@id": "https://pipminder00.github.io/#/schema/image/1",
        "url": "https://pipminder00.github.io/images/default.png",
        "width": 453 ,
        "height": 455 ,
        "caption": "Aminah Abdulah"
      }
    },
    {
      "@type": "WebSite",
      "@id": "https://pipminder00.github.io/#/schema/website/1",
      "url": "https://pipminder00.github.io/",
      "name": "PipMinder00 Blog",
      "description": "Personal blog site of Aminah Abdulah.",
      "publisher": {
        "@id": "https://pipminder00.github.io/#/schema/person/1"
      }
    },
    {
      "@type": "WebPage",
      "@id": "https://pipminder00.github.io/posts/apt/",
      "url": "https://pipminder00.github.io/posts/apt/",
      "name": "APT1 Hitman CTFs | Macro \u0026 Network",
      "description": "Personal blog site of Aminah Abdulah.",
      "isPartOf": {
        "@id": "https://pipminder00.github.io/#/schema/website/1"
      },
      "about": {
        "@id": "https://pipminder00.github.io/#/schema/person/1"
      },
      "datePublished": "2023-07-11T03:23:58+03:00",
      "dateModified": "2023-07-11T03:23:58+03:00",
      "breadcrumb": {
        "@id": "https://pipminder00.github.io/posts/apt/#/schema/breadcrumb/1"
      },
      "primaryImageOfPage": {
        "@id": "https://pipminder00.github.io/posts/apt/#/schema/image/2"
      },
      "inLanguage": "en-US",
      "potentialAction": [{
        "@type": "ReadAction", "target": ["https://pipminder00.github.io/posts/apt/"]
      }]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://pipminder00.github.io/posts/apt/#/schema/breadcrumb/1",
      "name": "Breadcrumbs",
      "itemListElement": [{
        "@type": "ListItem",
        "position":  1 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://pipminder00.github.io/",
          "url": "https://pipminder00.github.io/",
          "name": "Home"
          }
        },{
        "@type": "ListItem",
        "position":  2 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://pipminder00.github.io/posts/",
          "url": "https://pipminder00.github.io/posts/",
          "name": "Posts"
          }
        },{
        "@type": "ListItem",
        "position":  3 ,
        "item": {
          "@id": "https://pipminder00.github.io/posts/apt/"
          }
        }]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Article",
          "@id": "https://pipminder00.github.io/#/schema/article/1",
          "headline": "APT1 Hitman CTFs | Macro \u0026 Network",
          "description": "",
          "isPartOf": {
            "@id": "https://pipminder00.github.io/posts/apt/"
          },
          "mainEntityOfPage": {
            "@id": "https://pipminder00.github.io/posts/apt/"
          },
          "datePublished": "2023-07-11T03:23:58+03:00",
          "dateModified": "2023-07-11T03:23:58+03:00",
          "author": {
            "@id": "https://pipminder00.github.io/#/schema/person/1"
          },          
          "publisher": {
            "@id": "https://pipminder00.github.io/#/schema/person/1"
          },
          "image": {
            "@id": "https://pipminder00.github.io/posts/apt/#/schema/image/2"
          }
        }
      ]
    },{
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "ImageObject",
          "@id": "https://pipminder00.github.io/posts/apt/#/schema/image/2",
          "url": "https://pipminder00.github.io/images/default.png",
          "contentUrl": "https://pipminder00.github.io/images/default.png",
          "caption": "APT1 Hitman CTFs | Macro \u0026 Network"
        }
      ]
    }
  ]
}
</script>
  

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

  

</head><body>
    <header class="container">
  <nav class="main-nav" id="js-navbar">
    <a class="logo" href="https://pipminder00.github.io/">PipMinder00 Blog</a>
    <ul class="menu" id="js-menu">
      
      
      
        <li class="menu-item">
          <a href="/about/" class="menu-link">About</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/contact/" class="menu-link">Contact</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/posts/" class="menu-link">All Posts</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/categories/" class="menu-link">Explore by category </a>
        </li>
      
      
      <li class="menu-item--align">
        <div class="switch">
          <input class="switch-input" type="checkbox" id="themeSwitch">
          <label aria-hidden="true" class="switch-label" for="themeSwitch">On</label>
          <div aria-hidden="true" class="switch-marker"></div>
        </div>
      </li>
    </ul>
    <span class="nav-toggle" id="js-navbar-toggle">
      <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="30" height="30" fill="var(--color-contrast-high)"><rect y="11" width="24" height="2" rx="1"/><rect y="4" width="24" height="2" rx="1"/><rect y="18" width="24" height="2" rx="1"/></svg>
    </span>
  </nav>
</header><main class="section">
<div class="container">
  <section class="page-header">
    <h1 class="page-header-title">APT1 Hitman CTFs | Macro &amp; Network</h1>
    <div class="post-list-meta">
      <div class="post-list-dates">Jul 11, 2023&nbsp;&middot;&nbsp;2 min.</div>
      
      <div class="post-list-categories">
        
          <a href="https://pipminder00.github.io/categories/ctf/">CTF</a>
        
          <a href="https://pipminder00.github.io/categories/dfir/">DFIR</a>
        
      </div>
      
      
    </div>
    <p class="page-header-desc"></p>
    <div class="single-terms">
      
    </div>
  </section>
</div>
<div class="single-container-post", dir ="rtl">
  

  <aside class="toc">
    <div id="js-toc-toggle">
      <h2 class="toc-header">Table of Contents</h2>
      <span class="toc-drop-icon">&blacktriangledown;</span>
    </div>
    <div id="js-toc-contents" class="toc-contents"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1--word-docx-analysis">1- Word docx analysis</a></li>
        <li><a href="#2--olevba-tool">2- OleVBA tool</a></li>
        <li><a href="#3--dynamaic-analysis-with-procomon">3- Dynamaic analysis with procomon</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
  </aside>

  <div class="single-post-contents">
    <div class="single-feature-img">



  

</div>
    <article class="markdown">
        <p>بسم الله الرحمن الرحيم</p>
<p>بكتب اليوم لكم عن تحدي APT1 اللي نزله hitman بتويتر، حللت أبو التحدي الصراحه
رهيب! أول مرة احلل وانا فاهمه بوريكم 3 طرق تحلونه فيه</p>
<ol>
<li>نستخدم macro editor حق word نفسه</li>
<li>نستخدم تولز اسمها OleVba ونحلل منها</li>
<li>نشوف procmon</li>
</ol>
<p>نبدأ ؟</p>
<p>أول شيء عطانا ملف pcapng حق الشبكة
<figure><img src="apt1.png" width="100%"/>
</figure>
</p>
<p>سويت follow stream عشان افهم شنو اللي قاعد يصير ، فهمت ان عندي ملف يتسوى لها upload
<figure><img src="apt2.png" width="100%"/>
</figure>

<figure><img src="apt3.png" width="100%"/>
</figure>
</p>
<p>طيب نضغط عالباكيت ونشوف شنو data اللي قاعد يسوي له post ؟
<figure><img src="apt4.png" width="100%"/>
 </figure>
</p>
<p>حلوين نسوي export packet byte
<figure><img src="apt5.png" width="100%"/>
</figure>
</p>
<p>ونبدأ شغل عليها، طيب الحين لو غيرت ext لـ zip راح يحذفه لي windows defender فخلونا ننقل الملفات الى isolated machine
هنا عرفت انه word بوريكم شي يوضح لكم فكرة مايكروسفت في حفظ docm</p>
<p><figure><img src="apt6.png" width="100%"/>
</figure>

<a href="https://www.decalage.info/vba_tools" target="_blank" rel="noopener">https://www.decalage.info/vba_tools</a> المصدر :
<figure><img src="apt7.png" width="100%"/>
</figure>

<figure><img src="apt8.png" width="100%"/>
</figure>
</p>
<p>ممتاز وصلنا خير الحين بغير extension وأخليها docm وبمشي معاكم وأوريكم 3 طرق اللي تكلمت عنها فوق</p>
<h3 id="1--word-docx-analysis">1- Word docx analysis<a href="#1--word-docx-analysis">
    <svg role="img" aria-labelledby="1--word-docx-analysis-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="1--word-docx-analysis-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h3><p>نفتحها بالوورد
<figure><img src="apt9.png" width="100%"/>
</figure>
</p>
<p>لو فتحنا الماكرو بدون ما نشغلها من visual basic نقدر نشوف ونوصل لرابط الفلاق عاليمين بس نسوي replace حق الكلمات اللي حاطها
<figure><img src="apt10.png" width="100%"/>
</figure>
</p>
<h3 id="2--olevba-tool">2- OleVBA tool<a href="#2--olevba-tool">
    <svg role="img" aria-labelledby="2--olevba-tool-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="2--olevba-tool-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h3><p>نستخدم أداة OleVBA هنا عطتنا معلومات عن الملف
<figure><img src="apt11.png" width="100%"/>
</figure>
</p>
<p>نقدر بعد نسوي له reveal عشان نشوف source code
<figure><img src="apt12.png" width="100%"/>
</figure>
</p>
<h3 id="3--dynamaic-analysis-with-procomon">3- Dynamaic analysis with procomon<a href="#3--dynamaic-analysis-with-procomon">
    <svg role="img" aria-labelledby="3--dynamaic-analysis-with-procomon-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="3--dynamaic-analysis-with-procomon-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h3><p>أخيرًا ممكن نستخدم procmon ونشوف التغيرات اللي تصير بعد ما يشتغل الماكرو
نحط الفلتر
<figure><img src="apt13.png" width="100%"/>
 </figure>

نشغل الماكرو
<figure><img src="apt14.png" width="100%"/>
</figure>
1</p>
<p>نشيك عالنتائج ،،،
<figure><img src="apt15.png" width="100%"/>
</figure>
</p>
<p>ههههههههههههههه ماكو شي! ما اشتغل معي الماكرو والصراحة ما حمل الملف بالباث اللي طلع معانا بالتحليلات أهم شي الفكرة وصلت اذا حمل معاكم وروني سويت كل الطرق عشان أصير ضحية بس ماكو فايدة 😂😂
<figure><img src="apt16.png" width="100%"/>
</figure>
</p>

    </article>
    <aside>
      <div class="single-terms">
        
      </div>
      
  
  
  

  <section>
    <h2>Share</h2>
    <div class="social-links">
      <ul class="social-icons--share">
        
        
        <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fpipminder00.github.io%2fposts%2fapt%2f&amp;text=APT1%20Hitman%20CTFs%20%7c%20Macro%20%26%20Network" target="_blank" rel="noopener" aria-label="Share on Twitter" class="social-btn twitter">
          <li><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter" width="24" height="24" viewBox="0 0 384 312" fill="var(--color-primary)"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg></li>
        </a>
        
        
        
        
        
        
        
        
        
        

  
  

        
  <section>
    <h2>Read Next</h2>
    <div class="single-next-previous">
      
        <a class="previous" href="https://pipminder00.github.io/posts/api_hooking/">&laquo; API hooking techniques &amp; forensics analysis</a>
      
      
    </div>
  </section>

      
    </aside>
  </div>
</div>

    </main><footer>
  
  <div class="section footer">
    <p class="footer-copyright">&copy; 2023 &middot; 
      <a href="https://pipminder00.github.io/">PipMinder00 Blog</a>
      
        <span>&middot; Built with <a href="https://github.com/wjh18/hugo-liftoff" target="_blank" rel="noopener">Hugo Liftoff</a> theme.</span>
      
    </p>
    
      <div class="footer-socials">
        
<div class="social-links">
  <ul class="social-icons">
    
    
    <li>
      <a href="https://twitter.com/amenaham" target="_blank" rel="noopener" aria-label="Visit Twitter profile" class="social-btn twitter">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter" width="24" height="24" viewBox="0 0 384 312" fill="var(--color-primary)"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
      </a>
    </li>
    

    
    
    <li>
      <a href="https://github.com/pipminder00" target="_blank" rel="noopener" aria-label="Visit Github profile" class="social-btn github">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-github" width="24" height="24" viewBox="0 0 24 24" fill="var(--color-primary)"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
      </a>
    </li>
    

    
    

    
    

    
    
  </ul>
</div>
      </div>
    
  </div>
</footer>

  








  
  
    

<script src="https://pipminder00.github.io/main.min.js"></script>



  
</body>
</html>
